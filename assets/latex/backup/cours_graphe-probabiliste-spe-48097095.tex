\input{_header}
\meta{url}{/cours/graphe-probabiliste-spe/}
\meta{pid}{1163}
\meta{titre}{Graphe probabiliste [spé]}
\meta{type}{cours}
\begin{h2}I. Étude d'un exemple\end{h2}
On étudie la propagation d'une maladie dans une population.
\par
On choisit au hasard une personne dans cette population.
\par
On note :
\begin{itemize}
     \item $M_n$ l'événement \og la personne est malade le $n$ième jour de l'étude \fg{} ;
     \item $\overline{M_n}$ l'événement \og la personne est saine le $n$ième jour de l'étude \fg{} ;
     \item $p_n$ la probabilité de l'événement $M_n$ ;
     \item $q_n$ la probabilité de l'événement $\overline{M_n}$.
\end{itemize}
On suppose que :
\begin{itemize}
     \item la probabilité qu'une personne malade soit guérie le lendemain est $0,3$ ;
     \item la probabilité qu'une personne saine tombe malade le lendemain est $0,2$.
\end{itemize}
Au début de l'étude, la maladie touche 5 \% de la population. On a donc $p_0=0,05$ et $q_0=0,95$.
\bloc{orange}{a. Utilisation d'un arbre}{% id="e010"
     On peut représenter la situation au jour 0 et au jour 1 par l'arbre ci-dessous :
     \begin{center}
          \begin{extern} %width="350" alt="arbre pondéré" class="aligncenter"
               % Racine à Gauche, développement vers la droite
               \begin{tikzpicture}[xscale=1,yscale=1]
                    % Styles (MODIFIABLES)
                    \tikzstyle{fleche}=[-,>=latex,thick]
                    \tikzstyle{noeud}=[fill=white,circle,draw]
                    \tikzstyle{feuille}=[fill=white,circle,draw]
                    \tikzstyle{etiquette}=[midway,fill=white]
                    % Dimensions (MODIFIABLES)
                    \def\DistanceInterNiveaux{3}
                    \def\DistanceInterFeuilles{2}
                    % Dimensions calculées (NON MODIFIABLES)
                    \def\NiveauA{(0)*\DistanceInterNiveaux}
                    \def\NiveauB{(1.5)*\DistanceInterNiveaux}
                    \def\NiveauC{(2.5)*\DistanceInterNiveaux}
                    \def\InterFeuilles{(-1)*\DistanceInterFeuilles}
                    % Noeuds (MODIFIABLES : Styles et Coefficients d'InterFeuilles)
                    \node[noeud] (R) at ({\NiveauA},{(1.5)*\InterFeuilles}) {$\ $};
                    \node[noeud] (Ra) at ({\NiveauB},{(0.5)*\InterFeuilles}) {$M_0$};
                    \node[feuille] (Raa) at ({\NiveauC},{(0)*\InterFeuilles}) {$M_1$};
                    \node[feuille] (Rab) at ({\NiveauC},{(1)*\InterFeuilles}) {$\overline{M_1}$};
                    \node[noeud] (Rb) at ({\NiveauB},{(2.5)*\InterFeuilles}) {$\overline{M_0}$};
                    \node[feuille] (Rba) at ({\NiveauC},{(2)*\InterFeuilles}) {$M_1$};
                    \node[feuille] (Rbb) at ({\NiveauC},{(3)*\InterFeuilles}) {$\overline{M_1}$};
                    % Arcs (MODIFIABLES : Styles)
                    \draw[fleche] (R)--(Ra) node[etiquette] {$0,05$};
                    \draw[fleche] (Ra)--(Raa) node[etiquette] {$0,7$};
                    \draw[fleche] (Ra)--(Rab) node[etiquette] {$0,3$};
                    \draw[fleche] (R)--(Rb) node[etiquette] {$0,95$};
                    \draw[fleche] (Rb)--(Rba) node[etiquette] {$0,2$};
                    \draw[fleche] (Rb)--(Rbb) node[etiquette] {$0,8$};
               \end{tikzpicture}
          \end{extern}
     \end{center}
     La formule des probabilités totales permet de calculer les probabilités $p_1$ et $q_1$ :
     \par
     $p_1=0,05\times 0,7 + 0,95\times 0,2 = 0,225$
     \par
     $q_1 =0,05\times 0,3 + 0,95\times 0,8  = 0,775$
     \par
     De même, on peut représenter l'évolution du jour $n$ au jour $n+1$ grâce à l'arbre ci-dessous :
     \begin{center}
          \begin{extern} %width="350" alt="arbre pondéré" class="aligncenter"
               % Racine à Gauche, développement vers la droite
               \begin{tikzpicture}[xscale=1,yscale=1]
                    % Styles (MODIFIABLES)
                    \tikzstyle{fleche}=[-,>=latex,thick]
                    \tikzstyle{noeud}=[fill=white,circle,draw]
                    \tikzstyle{feuille}=[fill=white,circle,draw]
                    \tikzstyle{etiquette}=[midway,fill=white]
                    % Dimensions (MODIFIABLES)
                    \def\DistanceInterNiveaux{3}
                    \def\DistanceInterFeuilles{2}
                    % Dimensions calculées (NON MODIFIABLES)
                    \def\NiveauA{(0)*\DistanceInterNiveaux}
                    \def\NiveauB{(1.5)*\DistanceInterNiveaux}
                    \def\NiveauC{(2.5)*\DistanceInterNiveaux}
                    \def\InterFeuilles{(-1)*\DistanceInterFeuilles}
                    % Noeuds (MODIFIABLES : Styles et Coefficients d'InterFeuilles)
                    \node[noeud] (R) at ({\NiveauA},{(1.5)*\InterFeuilles}) {$\ $};
                    \node[noeud] (Ra) at ({\NiveauB},{(0.5)*\InterFeuilles}) {$M_n$};
                    \node[feuille] (Raa) at ({\NiveauC},{(0)*\InterFeuilles}) {$M_{n+1}$};
                    \node[feuille] (Rab) at ({\NiveauC},{(1)*\InterFeuilles}) {$\overline{M_{n+1}}$};
                    \node[noeud] (Rb) at ({\NiveauB},{(2.5)*\InterFeuilles}) {$\overline{M_n}$};
                    \node[feuille] (Rba) at ({\NiveauC},{(2)*\InterFeuilles}) {$M_{n+1}$};
                    \node[feuille] (Rbb) at ({\NiveauC},{(3)*\InterFeuilles}) {$\overline{M_{n+1}}$};
                    % Arcs (MODIFIABLES : Styles)
                    \draw[fleche] (R)--(Ra) node[etiquette] {$p_n$};
                    \draw[fleche] (Ra)--(Raa) node[etiquette] {$0,7$};
                    \draw[fleche] (Ra)--(Rab) node[etiquette] {$0,3$};
                    \draw[fleche] (R)--(Rb) node[etiquette] {$q_n$};
                    \draw[fleche] (Rb)--(Rba) node[etiquette] {$0,2$};
                    \draw[fleche] (Rb)--(Rbb) node[etiquette] {$0,8$};
               \end{tikzpicture}
          \end{extern}
     \end{center}
     On obtient, en utilisant à nouveau la formule des probabilités totales :
     \par
     $p_{n+1}=0,7 p_n + 0,2 q_n$
     \par
     $q_{n+1}=0,3 p_n + 0,8 q_n$.
}
\bloc{orange}{b. Graphe probabiliste}{% id="e020"
     À une date donnée, un individu se trouve dans l'un ou l'autre des deux états suivants :
     \begin{itemize}
          \item la personne est malade (état noté M)
          \item la personne est saine (état noté S)
     \end{itemize}
     Un \textbf{graphe probabiliste} représente ces deux \textbf{états} sous la forme de \textbf{sommets} et les \textbf{probabilités} de passer d'un état à l'autre sous la forme d'\textbf{arcs orientés}.
     \par
     Dans notre exemple, on obtient le graphe suivant :
     \begin{center}
          \begin{extern}%width="450" alt="graphe probabiliste d'ordre 2"
               \psset{unit=1cm}
               \begin{pspicture}(-2,-1)(8,1)
                    %\psgrid[subgriddiv=2,gridlabels=0,gridcolor=gray]
                    \psset{nodesep=3pt,arcangle=-15,arrowsize=3pt 3}
                    %%% Données à entrer
                    %%% G pour Gauche, d pour Droit
                    \def\nomG{$M$} \def\nomD{$S$}
                    \def\valGG{$0,7$} \def\valGD{$0,3$}
                    \def\valDG{$0,2$} \def\valDD{$0,8$}
                    %%% couleurs des sommets
                    \newrgbcolor{colorG}{0 0 1} \newrgbcolor{colorD}{1 0 0}
                    %%%
                    %%% Ne plus rien modifier à partir de cette ligne %%%
                    %%%
                    \psnode(0,0){G}{\colorG  \nomG}
                    \psnode(6,0){D}{\colorD  \nomD}
                    \psset{ArrowInside=->,ArrowInsideNo=1,arrowscale=1}
                    %%%
                    \nccircle[angleA=90,linecolor=colorG]{->}{G}{.5cm}  \Bput{\colorG \valGG}
                    \ncarc[linecolor=colorG]{G}{D} \Bput{\colorG \valGD}
                    %%%
                    \ncarc[linecolor=colorD]{D}{G} \Bput{\colorD \valDG}
                    \nccircle[angleA=-90,linecolor=colorD]{->}{D}{.5cm} \Bput{\colorD  \valDD}
               \end{pspicture}
          \end{extern}
     \end{center}
     On remarque que la somme des probabilités issues d'un même sommet (en bleu pour M et en rouge pour S) est toujours égale à 1.
}
\bloc{orange}{c. Matrice de transition}{% id="e030"
     Les relations trouvées grâce à l'arbre :
     \par
     $p_{n+1}=0,7 p_n + 0,2 q_n$
     \par
     $q_{n+1}=0,3 p_n + 0,8 q_n$
     \par
     peuvent s'écrire sous forme matricielle :
     \par
     $A=\begin{pmatrix}  p_{n+1} & q_{n+1} \end{pmatrix} = \begin{pmatrix}  p_{n} & q_{n} \end{pmatrix} \times \begin{pmatrix}  0,7 & 0,3 \\ 0,2 & 0,8 \end{pmatrix}$
     \par
     N.B. Vérifier le en effectuant le calcul :  $\begin{pmatrix}  p_{n} & q_{n} \end{pmatrix} \times \begin{pmatrix}  0,7 & 0,3 \\ 0,2 & 0,8 \end{pmatrix}$.
     \par
     En notant $T = \begin{pmatrix}  0,7 & 0,3 \\ 0,2 & 0,8 \end{pmatrix}$ et pour tout entier naturel $n$, $P_n = \begin{pmatrix}  p_{n} & q_{n} \end{pmatrix}$, la relation précédente s'écrit :
     \par
     $ p_{n+1}=P_n \times T  $
     \par
     La matrice $T$ s'appelle \textbf{matrice de transition} et les matrices lignes $P_n$, \textbf{états probabilistes}.
     \par
     On a alors :
     \par
     $ p_{1}=P_0 \times T  $ où $P_0$ est l'état initial$P_0=\begin{pmatrix}  p_{0} & q_{0} \end{pmatrix}=\begin{pmatrix}  0,05 & 0,95 \end{pmatrix}$
     \par
     $ p_{2}=P_1 \times T=P_0 \times T  \times T = P_0 \times T^2 $
     \par
     $ p_{3}=P_2 \times T=P_0 \times T^2  \times T = P_0 \times T^3 $
     \par
     et ainsi de suite...
     \par
     $ p_{n}= P_0 \times T^n $
     \par
     Par exemple, l'état probabiliste au cinquième jour sera :
     \par
     $ p_{5}= P_0 \times T^5 $
     \par
     À la calculatrice, on trouve $ p_{5}=\begin{pmatrix}  0,389 & 0,611 \end{pmatrix}$ (au millième près).
     \par
     Le cinquième jour, 38,9\% de la population sera malade.
}
\begin{h2}II. Graphe probabiliste - Matrice de transition\end{h2}
Dans toute cette partie, on considère un système possédant $n$ états possibles notés $A_1$, $A_2$, ... $A_n$. Ce système peut changer d'état au cours du temps et on suppose que la probabilité de passer de l'état $A_i$ à l'état $A_j$ reste constante.
\cadre{bleu}{Définition}{% id="d030"
     Un \textbf{graphe probabiliste} est un graphe orienté et pondéré dans lequel :
     \begin{itemize}
          \item Les sommets du graphe représentent les différents états possibles d'un système
          \item Les poids des arcs indiquent les probabilités de passage d'un état à l'autre
     \end{itemize}
     Dans un graphe orienté, la somme des poids des arcs issus d'un même sommet est égale à 1.
}
\bloc{orange}{Exemples}{% id="e033"
     \textbf{a. Graphe probabiliste d'ordre 2}
     \begin{center}
          \begin{extern}%width="450" alt="graphe probabiliste d'ordre 2"
               \psset{unit=1cm}
               \begin{pspicture}(-2,-1)(8,1)
                    %\psgrid[subgriddiv=2,gridlabels=0,gridcolor=gray]
                    \psset{nodesep=3pt,arcangle=-15,arrowsize=3pt 3}
                    %%% Données à entrer
                    %%% G pour Gauche, d pour Droit
                    \def\nomG{$A_1$} \def\nomD{$A_2$}
                    \def\valGG{$0,7$} \def\valGD{$0,3$}
                    \def\valDG{$0,2$} \def\valDD{$0,8$}
                    %%% couleurs des sommets G et H
                    \newrgbcolor{colorG}{0 0 0} \newrgbcolor{colorD}{0 0 0}
                    %%%
                    %%% Ne plus rien modifier à partir de cette ligne %%%
                    %%%
                    \psnode(0,0){G}{\colorG  \nomG}
                    \psnode(6,0){D}{\colorD  \nomD}
                    \psset{ArrowInside=->,ArrowInsideNo=1,arrowscale=1}
                    %%%
                    \nccircle[angleA=90,linecolor=colorG]{->}{G}{.5cm}  \Bput{\colorG \valGG}
                    \ncarc[linecolor=colorG]{G}{D} \Bput{\colorG \valGD}
                    %%%
                    \ncarc[linecolor=colorD]{D}{G} \Bput{\colorD \valDG}
                    \nccircle[angleA=-90,linecolor=colorD]{->}{D}{.5cm} \Bput{\colorD  \valDD}
               \end{pspicture}
          \end{extern}
     \end{center}
     \begin{center}Graphe probabiliste à 2 états $A_1$ et $A_2$\end{center}
     \textbf{b. Graphe probabiliste d'ordre 3}
     \begin{center}
          \begin{extern}%width="450" alt="graphe probabiliste d'ordre 3"
               \psset{unit=1cm}
               \begin{pspicture}(-2,-1)(8,6.5)
                    %\psgrid[subgriddiv=2,gridlabels=0,gridcolor=gray]
                    \psset{nodesep=3pt,arcangle=-15,arrowsize=3pt 3}
                    %%% Données à entrer
                    %%% G pour Gauche, d pour Droit et H pour Haut
                    \def\nomG{$A_1$} \def\nomD{$A_2$} \def\nomH{$A_3$}
                    \def\valGG{$0,5$} \def\valGD{$0,2$} \def\valGH{$0,3$}
                    \def\valDG{$0,5$} \def\valDD{$0,1$} \def\valDH{$0,4$}
                    \def\valHG{$0,8$} \def\valHD{$0,1$} \def\valHH{$0,1$}
                    %%% couleurs des sommets G et H
                    \newrgbcolor{colorG}{0 0 0} \newrgbcolor{colorD}{0 0 0} \newrgbcolor{colorH}{0 0 0}
                    %%%
                    %%% Ne plus rien modifier à partir de cette ligne %%%
                    %%%
                    \psnode(0,0){G}{\colorG  \nomG}
                    \psnode(6,0){D}{\colorD  \nomD}
                    \psnode(6;60){H}{\colorH \nomH}
                    \psset{ArrowInside=->,ArrowInsideNo=1,arrowscale=1}
                    %%%
                    \nccircle[angleA=90,linecolor=colorG]{->}{G}{.5cm}  \Bput{\colorG \valGG}
                    \ncarc[linecolor=colorG]{G}{D} \Bput{\colorG \valGD}
                    \ncarc[linecolor=colorG]{G}{H} \Bput{\colorG \valGH}
                    %%%
                    \ncarc[linecolor=colorD]{D}{G} \Bput{\colorD \valDG}
                    \nccircle[angleA=-90,linecolor=colorD]{->}{D}{.5cm} \Bput{\colorD  \valDD}
                    \ncarc[linecolor=colorD]{D}{H} \Bput{\colorD \valDH}
                    %%%
                    \ncarc[linecolor=colorH]{H}{G} \Bput{\colorH \valHG}
                    \ncarc[linecolor=colorH]{H}{D} \Bput{\colorH \valHD}
                    \nccircle[angleA=0,linecolor=colorH]{->}{H}{.5cm} \Bput{\colorH \valHH}
               \end{pspicture}
          \end{extern}
     \end{center}
     \begin{center}Graphe probabiliste à 3 états $A_1$, $A_2$ et $A_3$\end{center}
}
\cadre{bleu}{Définition}{% id="d035"
     Soit un graphe probabiliste d'ordre $n$.
     \par
     Les \textbf{états probabilistes} $P_k$ sont des matrices à une ligne à $n$ colonnes qui indiquent pour chacun des $n$ sommets, la probabilité de se trouver dans cet état à l'étape $k$.
     \par
     La somme des coefficients d'un état probabiliste est égale à 1.
}
\bloc{orange}{Remarques}{% id="e037"
     \begin{itemize}
          \item L'état probabiliste $P_0$ s'appelle l'état probabiliste \textbf{initial}.
          \item Pour un système à deux états A et B, les états probabilistes seront de la forme $P_k = \begin{pmatrix}  p_k & q_k \end{pmatrix} $ où $p_k$ et $q_k$ sont les probabilités de se trouver  respectivement dans les états A et B à l'étape $k$.
          \par
          Le système se trouvant, à chaque étape, soit dans l'état A soit dans l'état B, on aura, pour tout entier naturel $k$, $p_k + q_k = 1$
          \item Pour un système à trois états, les états probabilistes seront de la forme $P_k = \begin{pmatrix}  p_k & q_k & r_k\end{pmatrix} $ avec, pour tout entier naturel $k$, $p_k + q_k + r_k = 1  $.
     \end{itemize}
}
\cadre{bleu}{Définition}{% id="d040"
     Soit un graphe probabiliste d'ordre $n$ dont les états sont notés $A_1$, $A_2$, ... $A_n$.
     \par
     La \textbf{matrice de transition} associée un graphe probabiliste d'ordre $n$ est une matrice carrée $n \times n$ dont le terme $p_{i,j}$ situé à l'intersection de la $i$-ème ligne et de la $j$-ème colonne représente la probabilité de passer de l'état $A_i$ à l'état $A_j$.
     \par
     Dans une matrice de transition, la somme des coefficients situés sur une même ligne est égale à 1.
}
\bloc{orange}{Exemples}{% id="e033"
     \textbf{a. Graphe probabiliste d'ordre 2}
     \par
     Considérons le graphe probabiliste suivant~:
     \begin{center}
          \begin{extern}%width="450" alt="graphe probabiliste d'ordre 2"
               \psset{unit=1cm}
               \begin{pspicture}(-2,-1)(8,1)
                    %\psgrid[subgriddiv=2,gridlabels=0,gridcolor=gray]
                    \psset{nodesep=3pt,arcangle=-15,arrowsize=3pt 3}
                    %%% Données à entrer
                    %%% G pour Gauche, d pour Droit
                    \def\nomG{$A_1$} \def\nomD{$A_2$}
                    \def\valGG{$0,1$} \def\valGD{$0,9$}
                    \def\valDG{$0,4$} \def\valDD{$0,6$}
                    %%% couleurs des sommets G et H
                    \newrgbcolor{colorG}{0 0 0} \newrgbcolor{colorD}{0 0 0}
                    %%%
                    %%% Ne plus rien modifier à partir de cette ligne %%%
                    %%%
                    \psnode(0,0){G}{\colorG  \nomG}
                    \psnode(6,0){D}{\colorD  \nomD}
                    \psset{ArrowInside=->,ArrowInsideNo=1,arrowscale=1}
                    %%%
                    \nccircle[angleA=90,linecolor=colorG]{->}{G}{.5cm}  \Bput{\colorG \valGG}
                    \ncarc[linecolor=colorG]{G}{D} \Bput{\colorG \valGD}
                    %%%
                    \ncarc[linecolor=colorD]{D}{G} \Bput{\colorD \valDG}
                    \nccircle[angleA=-90,linecolor=colorD]{->}{D}{.5cm} \Bput{\colorD  \valDD}
               \end{pspicture}
          \end{extern}
     \end{center}
     La matrice de transition associée à ce graphe est :
     \begin{center}
          \img{matrice-transition-2x2-ltx}{0.4}%width="280" alt="matrice de transition 2x2"
     \end{center}
     \textbf{b. Graphe probabiliste d'ordre 3}
     \par
     Dans l'exemple du graphe d'ordre 3 :
     \begin{center}
          \begin{extern}%width="450" alt="graphe probabiliste d'ordre 3"
               \psset{unit=1cm}
               \begin{pspicture}(-2,-1)(8,6.5)
                    %\psgrid[subgriddiv=2,gridlabels=0,gridcolor=gray]
                    \psset{nodesep=3pt,arcangle=-15,arrowsize=3pt 3}
                    %%% Données à entrer
                    %%% G pour Gauche, d pour Droit et H pour Haut
                    \def\nomG{$A_1$} \def\nomD{$A_2$} \def\nomH{$A_3$}
                    \def\valGG{$0,5$} \def\valGD{$0,2$} \def\valGH{$0,3$}
                    \def\valDG{$0,5$} \def\valDD{$0,1$} \def\valDH{$0,4$}
                    \def\valHG{$0,8$} \def\valHD{$0,1$} \def\valHH{$0,1$}
                    %%% couleurs des sommets G et H
                    \newrgbcolor{colorG}{0 0 0} \newrgbcolor{colorD}{0 0 0}\newrgbcolor{colorH}{0 0 0}
                    %%%
                    %%% Ne plus rien modifier à partir de cette ligne %%%
                    %%%
                    \psnode(0,0){G}{\colorG  \nomG}
                    \psnode(6,0){D}{\colorD  \nomD}
                    \psnode(6;60){H}{\colorH \nomH}
                    \psset{ArrowInside=->,ArrowInsideNo=1,arrowscale=1}
                    %%%
                    \nccircle[angleA=90,linecolor=colorG]{->}{G}{.5cm}  \Bput{\colorG \valGG}
                    \ncarc[linecolor=colorG]{G}{D} \Bput{\colorG \valGD}
                    \ncarc[linecolor=colorG]{G}{H} \Bput{\colorG \valGH}
                    %%%
                    \ncarc[linecolor=colorD]{D}{G} \Bput{\colorD \valDG}
                    \nccircle[angleA=-90,linecolor=colorD]{->}{D}{.5cm} \Bput{\colorD  \valDD}
                    \ncarc[linecolor=colorD]{D}{H} \Bput{\colorD \valDH}
                    %%%
                    \ncarc[linecolor=colorH]{H}{G} \Bput{\colorH \valHG}
                    \ncarc[linecolor=colorH]{H}{D} \Bput{\colorH \valHD}
                    \nccircle[angleA=0,linecolor=colorH]{->}{H}{.5cm} \Bput{\colorH \valHH}
               \end{pspicture}
          \end{extern}
     \end{center}
     La matrice de transition est :
     \begin{center}
          \img{matrice-transition-3x3-ltx}{0.4}%width="320" alt="matrice de transition 3x3"
     \end{center}
}
\cadre{rouge}{Théorème}{% id="t080"
     Soit un système dont la matrice de transition est notée $T$, d'état initial $P_0$ et d'état probabiliste $P_k$ à l'étape $k$.
     \par
     Alors, pour tout entier naturel $k$ :
     \begin{itemize}
          \item $P_{k+1}=P_k \times T$
          \item $P_{k}=P_0 \times T^k$
     \end{itemize}
}
\bloc{cyan}{Démonstration}{% id="r090"
     Ce résultat se démontre en utilisant la formule des probabilités totales (voir partie {I. Étude d'un exemple } )
}
\bloc{cyan}{Remarque}{% id="r100"
     On peut rapprocher ces formules de celles obtenues pour les suites géométriques : $u_{n+1}=u_n \times q$ et $u_n=u_0 \times q^n$.
     \par
     Mais attention à l'ordre des matrices : le produit de matrices n'est pas commutatif !
}
\begin{h2}III. États stables\end{h2}
\cadre{bleu}{Définition}{% id="d130"
     Soit un graphe probabiliste de matrice de transition $T$.
     \par
     Un \textbf{état stable} est un état probabiliste $P$ qui vérifie $P=P \times T$.
}
\bloc{cyan}{Remarque}{% id="r140"
     En pratique pour trouver un état stable :
     \begin{itemize}
          \item On pose $P= \begin{pmatrix} x & y \end{pmatrix} $ si le graphe possède 2 états ( ou $P= \begin{pmatrix} x & y & z \end{pmatrix} $ si le graphe possède 3 états)
          \item On écrit le système correspondant à l'égalité matricielle $P=P \times T$
          \item On ajoute au système l'équation $x+y=1$ ( ou $x+y+z=1$ si le graphe possède 3 états ) qui caractérise les états probabilistes ( la somme des coefficients est égale à 1)
          \item On résout le système obtenu...
     \end{itemize}
}
\bloc{orange}{Exemple}{% id="e145"
     Reprenons le graphe :
     \begin{center}
          \begin{extern}%width="450" alt="graphe probabiliste d'ordre 2"
               \psset{unit=1cm}
               \begin{pspicture}(-2,-1)(8,1)
                    %\psgrid[subgriddiv=2,gridlabels=0,gridcolor=gray]
                    \psset{nodesep=3pt,arcangle=-15,arrowsize=3pt 3}
                    %%% Données à entrer
                    %%% G pour Gauche, d pour Droit
                    \def\nomG{$A_1$} \def\nomD{$A_2$}
                    \def\valGG{$0,1$} \def\valGD{$0,9$}
                    \def\valDG{$0,4$} \def\valDD{$0,6$}
                    %%% couleurs des sommets G et H
                    \newrgbcolor{colorG}{0 0 0} \newrgbcolor{colorD}{0 0 0}
                    %%%
                    %%% Ne plus rien modifier à partir de cette ligne %%%
                    %%%
                    \psnode(0,0){G}{\colorG  \nomG}
                    \psnode(6,0){D}{\colorD  \nomD}
                    \psset{ArrowInside=->,ArrowInsideNo=1,arrowscale=1}
                    %%%
                    \nccircle[angleA=90,linecolor=colorG]{->}{G}{.5cm}  \Bput{\colorG \valGG}
                    \ncarc[linecolor=colorG]{G}{D} \Bput{\colorG \valGD}
                    %%%
                    \ncarc[linecolor=colorD]{D}{G} \Bput{\colorD \valDG}
                    \nccircle[angleA=-90,linecolor=colorD]{->}{D}{.5cm} \Bput{\colorD  \valDD}
               \end{pspicture}
          \end{extern}
     \end{center}
     La matrice de transition associée est $T= \begin{pmatrix} 0,1 & 0,9  \\  0,4 & 0,6 \end{pmatrix}$.
     \par
     En posant $P= \begin{pmatrix} x & y  \end{pmatrix}$ on obtient le système
     \par
     $ \begin{cases} x = 0,1x+0,4y \\ y = 0,9x+0,6y \\ x+y=1\end{cases} $
     \par
     qui est équivalent à :
     \par
     $ \begin{cases} 0,9x-0,4y=0 \\ 0,9x-0,4y=0 \\ y=1-x \end{cases} $
     \par
     Les deux premières équations sont identiques et en remplaçant $y$ par $1-x$ dans la première équation on obtient :
     \par
     $ \begin{cases} 0,9x-0,4(1-x)=0 \\  y=1-x \end{cases} $
     \par
     $ \begin{cases} x=\dfrac{4}{13} \\  \\ y=\dfrac{9}{13}  \end{cases} $
     \par
     Il y a donc un état stable $P = \begin{pmatrix} \dfrac{4}{13} & \dfrac{9}{13}  \end{pmatrix}$
}
\cadre{vert}{Propriété}{% id="p160"
     Si la matrice de transition d'un graphe probabiliste d'ordre 2 ou 3 ne comporte pas de coefficient nul, alors :
     \begin{itemize}
          \item le graphe possède un état stable $P$
          \item les états probabilistes $P_n$ tendent vers l'état stable $P$ quand $n$ devient grand.
     \end{itemize}
}
\bloc{cyan}{Remarques}{% id="r165"
     \begin{itemize}
          \item Cette propriété donne une condition suffisante mais non nécessaire. Il est possible qu'une matrice de transition comporte des coefficients nuls mais que le système converge malgré tout vers un état stable.
          \item Le résultat précédent est également valable si le degré du graphe est supérieur à 3 (mais n'est pas au programme dans ce cas). Il s'agit d'un cas particulier du \Lien{http://www.bibmath.net/dico/index.php?action=affiche&quoi=./p/perron-frobenius.html}{théorème de Perron-Frobenius}
     \end{itemize}
}
\input{_footer}